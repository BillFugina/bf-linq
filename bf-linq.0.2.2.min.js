"use strict";Array.prototype.remove=function(a){var b=this.indexOf(a);b>=0&&this.splice(b,1)},Array.prototype.delete=function(a){var b=this.indexOfFirst(a);b>=0&&this.splice(b,1)},Array.prototype.single=function(){if(1===this.length)return this[0];throw 0===this.length?"Collection has no items.":"Collection has more than one item."},Array.prototype.singleOrDefault=function(){if(0==this.length)return null;if(1==this.length)return this[0];throw"Collection has more than one item."},Array.prototype.first=function(a){if(!a&&this.length>0)return this[0];for(var b=null,c=0;null===b&&c<this.length;){var d=this[c];a(d,c)&&(b=d),c++}return b},Array.prototype.firstOrDefault=function(a){return 0==this.length?null:this.first(a)},Array.prototype.indexOfFirst=function(a){for(var b=-1,c=0;b<0&&c<this.length;)a(this[c],c)&&(b=c),c++;return b},Array.prototype.any=function(a){return null!=this.first(a)},Array.prototype.select=function(a){for(var b=[],c=0;c<this.length;c++){var d=this[c],e=a(d,c);b.push(e)}return b},Array.prototype.where=function(a){for(var b=[],c=0;c<this.length;c++)a(this[c],c)&&b.push(this[c]);return b},Array.prototype.distinct=function(a){var b,c=[];b=a?function(b){return!c.any(function(c){return a(c,b)})}:function(a){return c.indexOf(a)<0};for(var d=0,e=this;d<e.length;d++){var f=e[d];b(f)&&c.push(f)}return c},Array.prototype.count=function(a){return a?this.where(a).length:this.length},Array.prototype.aggregate=function(a,b){void 0===b&&(b=null);for(var c=0,d=this;c<d.length;c++){var e=d[c];b=a(b,e)}return b},Array.prototype.sum=function(a){a||(a=function(a){return a});for(var b=null,c=0,d=this;c<d.length;c++){var e=d[c];null==b?b=a(e):b+=a(e)}return b},Array.prototype.groupBy=function(a){for(var b=new Array,c=0,d=this;c<d.length;c++){var e=d[c],f=a(e),g=b.where(function(a){return a.key==f}).first();if(g)g.array.push(e);else{var h={key:f,array:[e]};b.push(h)}}return b},function(){function a(a,b){for(var c=new Array,d=0,e=a;d<e.length;d++){var f=e[d],g=b(f),h=c.where(function(a){return a.key==g}).first();if(h)h.array.push(f);else{var i={key:g,array:[f]};c.push(i)}}return c}function b(a,b){for(var c={},d=0,e=a;d<e.length;d++){var f=e[d],g=b(f),h=c[g];if(h)h.array.push(f);else{var i={key:g,array:[f]};c[g]=i}}var j=[];for(var k in c)c.hasOwnProperty(k)&&j.push(c[k]);return j}Array.prototype.groupBy=function(c){if(this.any()){var d=typeof c(this.first());if("string"==d||"number"==d)return b(this,c)}return a(this,c)}}(),Array.prototype.singleJoin=function(a,b,c,d){for(var e=new Array,f=0,g=a;f<g.length;f++){var h=g[f];e.push({key:c(h),value:h})}for(var i=new Array,j=0,k=this;j<k.length;j++){var l=k[j],m=b(l),h=e.first(function(a){return a.key==m}).value,n=d(l,h);i.push(n)}return i},Array.prototype.groupJoin=function(a,b,c){var d=a.groupBy(c),e=function(a){return a.key},f=function(a,b){return{key:a,array:b.array}};return this.singleJoin(d,b,e,f)},Array.prototype.last=function(a){if(!a&&this.length>0)return this[this.length-1];for(var b=null,c=this.length-1;null===b&&c>=0;){var d=this[c];a(d,c)&&(b=d),c--}return b};